(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-51bd548b"],{"1a50":function(t,e,i){},"1b62":function(t,e,i){"use strict";var n=i("495f"),a={computed:{inApp:function(){return Object(n["d"])()},shareLink:function(){return Object(n["b"])(location.href,"inapp")},clientType:function(){return Object(n["c"])()},isIOS:function(){return"isIos"===this.clientType},isAndroid:function(){return"isAnd"===this.clientType}}};e["a"]=a},"2d27":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"expand-bar-inter"},[i("div",{staticClass:"top"},[i("img",{attrs:{src:"https://img.topgamers.cn/img_f2679638_1623938358486.png"}})]),i("div",{staticClass:"center"},[i("img",{attrs:{src:"https://img.topgamers.cn/img_4643cfcb_1623938407735.png"}})]),i("a",{attrs:{href:"https://video.topgamers.cn/video_086300ab_1600242317241.mp4",target:"_blank"}},[i("div",{staticClass:"bottom"},[i("img",{attrs:{src:"https://img.topgamers.cn/img_1d529fda_1623938442871.png"}})])])])}],o={name:"ExpandBarPc"},s=o,r=(i("9b31"),i("2877")),c=Object(r["a"])(s,n,a,!1,null,"4a6342ee",null);e["a"]=c.exports},"39c5":function(t,e,i){},4434:function(t,e,i){},"6c65":function(t,e,i){"use strict";i("39c5")},"9b31":function(t,e,i){"use strict";i("a370")},a370:function(t,e,i){},a7de:function(t,e,i){"use strict";i("b2e7")},aa99:function(t,e,i){"use strict";i("1a50")},ac96:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"nav-box"},["isPc"===t.client?i("div",{staticClass:"pc-header"},[i("div",{staticClass:"logo"},[t._m(0),i("div",{staticClass:"text-box"},[i("el-dropdown",{on:{command:t.handleCommand}},[i("span",{staticClass:"el-dropdown-link"},[t._v(" "+t._s(t.mapName)),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"YuanshenMap"}},[t._v(" 提瓦特大陆地图 ")]),i("el-dropdown-item",{attrs:{command:"YuanshenAppleMap"}},[t._v(" 金苹果群岛 ")]),i("el-dropdown-item",{attrs:{command:"YuanshenInazuma"}},[t._v(" 稻妻城地图 ")])],1)],1)],1)])]):t._e(),"isPc"===t.client||t.inApp?t._e():i("div",{staticClass:"mobile-header"},[i("el-dropdown",{on:{command:t.handleCommand}},[i("span",{staticClass:"el-dropdown-link"},[t._v(" "+t._s(t.mapName)),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"YuanshenMap"}},[t._v(" 提瓦特大陆地图 ")]),i("el-dropdown-item",{attrs:{command:"YuanshenAppleMap"}},[t._v(" 金苹果群岛 ")]),i("el-dropdown-item",{attrs:{command:"YuanshenInazuma"}},[t._v(" 稻妻城地图 ")])],1)],1)],1),t.inApp?i("div",{staticClass:"app-nav"},[i("div",{staticClass:"back",on:{click:t.back2App}}),i("el-dropdown",{staticClass:"inAppDropdown",on:{command:t.handleCommand}},[i("span",{staticClass:"el-dropdown-link"},[t._v(" "+t._s(t.mapName)),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"YuanshenMap"}},[t._v(" 提瓦特大陆地图 ")]),i("el-dropdown-item",{attrs:{command:"YuanshenAppleMap"}},[t._v(" 金苹果群岛 ")]),i("el-dropdown-item",{attrs:{command:"YuanshenInazuma"}},[t._v(" 稻妻城地图 ")])],1)],1),i("i",{staticClass:"share",on:{click:t.onShareClick}})],1):t._e()])},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"img-box"},[i("img",{attrs:{src:"https://img.topgamers.cn/img_ebd76ce7_1623985819791.png"}})])}],o=i("495f"),s={name:"YuanHeader",props:{client:{type:String,default:""},inApp:{type:Boolean,default:!1},mapName:{type:String,default:""}},methods:{handleCommand:function(t){this.$router.push({name:t})},back2App:function(){this.inApp?Object(o["a"])({method:"closePage"}):this.$router.back()},onShareClick:function(){this.$emit("on-share")}}},r=s,c=(i("a7de"),i("2877")),l=Object(c["a"])(r,n,a,!1,null,"2822274a",null);e["a"]=l.exports},b2e7:function(t,e,i){},b9b6:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"yuanshen-map-inter",class:{"in-app":t.inApp}},[i("div",{staticClass:"nav"},[i("YuanHeader",{attrs:{mapName:t.mapResource.shareTitle,client:t.clientType,inApp:t.inApp},on:{"on-share":t.shareMap}})],1),t.mapResource?i("Map",{ref:"mapvm",staticClass:"map",attrs:{zoom:t.defaultZoom,tileImageProvider:t.mapTileGenerator}}):t._e(),i("PoiFilter",{directives:[{name:"show",rawName:"v-show",value:t.showFilter,expression:"showFilter"}],ref:"filter",staticClass:"filter",attrs:{items:t.categories},on:{close:function(e){t.showFilter=!1},"item-change":t.switchMarkersRelate,"all-item-change":t.switchAllMarkers}}),i("Menubar",{staticClass:"menus",attrs:{items:t.validMenus},on:{"click-item":t.doMenuAction}}),"isPc"===t.clientType?i("ExpandBarPc",{staticClass:"expandPc"}):t._e(),"isPc"===t.clientType||t.inApp?t._e():i("ExpandBarMobile",{staticClass:"expandMobile"}),t.modals.share?i("Sharebar",{on:{close:function(e){t.modals.share=!1},share:t.shareTo}}):t._e(),i("script",{attrs:{id:"infowindow-template",type:"x-tmpl-mustache"}},[t._v(' <div style=" width: 140px; height: 130px; background-image: url(#{background}#); background-repeat: no-repeat; background-size: 100% 100%; display: flex; flex-direction: column; " > <div style=" width: 100%; height: 43px; color: #5c5c5c; line-height: 43px; text-align: center; font-weight: bold; font-size: 10px; overflow: hidden; " > 地点：#{place}# </div> <div style=" width: 100%; height: 43px; color: #5c5c5c; line-height: 43px; text-align: center; font-weight: bold; font-size: 10px; overflow: hidden; " > 先行者：#{person}# </div> <div style=" width: 100%; height: 42px; display: flex; justify-content: center; align-items: center; " > <button style=" height: 25px; width: 65px; border-radius: 12px; background-color: #3a393a; color: #ffffff; font-weight: bold; font-size: 10px; margin-right: 5px; cursor: pointer; " onclick="window.__tg_map_redirect_challenge__(\'#{target}#\', \'#{target_param}#\', #{native}#)" > 查看视频 </button> <button style=" height: 25px; width: 65px; border-radius: 12px; background-color: #3a393a; color: #ffffff; font-weight: bold; font-size: 10px; margin-right: 5px; cursor: pointer; " onclick="window.__tg_map_point_light__(#{challenge_id}#, #{target_lighting}#, \'#{userId}#\', \'#{sign}#\')" > #{lighting_text}# </button> </div> </div> ')]),i("script",{attrs:{id:"infowindow-template-nologin",type:"x-tmpl-mustache"}},[t._v(' <div style=" width: 140px; height: 130px; background-image: url(#{background}#); background-repeat: no-repeat; background-size: 100% 100%; display: flex; flex-direction: column; " > <div style=" width: 100%; height: 43px; color: #5c5c5c; line-height: 43px; text-align: center; font-weight: bold; font-size: 10px; overflow: hidden; " > 地点：#{place}# </div> <div style=" width: 100%; height: 43px; color: #5c5c5c; line-height: 43px; text-align: center; font-weight: bold; font-size: 10px; overflow: hidden; " > 先行者：#{person}# </div> <div style=" width: 100%; height: 42px; display: flex; justify-content: center; align-items: center; " > <button style=" height: 25px; width: 65px; border-radius: 12px; background-color: #3a393a; color: #ffffff; font-weight: bold; font-size: 10px; margin-right: 5px; cursor: pointer; " onclick="window.__tg_map_redirect_challenge__(\'#{target}#\', \'#{target_param}#\', #{native}#)" > 查看视频 </button> </div> </div> ')])],1)},a=[],o=(i("99af"),i("4160"),i("a15b"),i("d81d"),i("b0c0"),i("7039"),i("d3b7"),i("ac1f"),i("25f0"),i("5319"),i("159b"),i("a5c9")),s=i("cdca"),r=i("0a9b"),c=i("a3d2"),l=i("2d27"),d=i("e923"),p=i("ac96"),h=i("9dbb"),u=i.n(h),m=i("4dec"),f=i("495f"),g=i("b1b0"),v=i.n(g),w=i("1b62");window.__tg_map_point_light__=function(t,e,i,n){if(""!=i&&""!=n){var a={challenge_id:t,is_lighting:e,userId:i,sign:n};Object(m["e"])(a).then((function(t){var i=t;200===i.code?(window.vue.$toast(e?"点亮成功":"取消点亮成功"),window.flushPoints()):window.vue.$toast(i.msg,{duration:1500})}))}else window.vue.$toast("请在app内登陆后使用此功能",{duration:1500})};var b={name:"YuanshenMap",mixins:[w["a"]],metaInfo:function(){return{title:"原神 | 高能时刻短视频",meta:[{hid:"description",name:"description",content:"高能时刻游戏短视频app，快来这个社区我给你看个宝贝"},{hid:"Keywords",name:"Keywords",content:"高能时刻,游戏短视频"}]}},components:{Map:o["a"],Menubar:r["a"],PoiFilter:c["a"],ExpandBarPc:l["a"],ExpandBarMobile:d["a"],YuanHeader:p["a"],Sharebar:s["a"]},data:function(){return{menus:[{id:0,title:"点位筛选",icon:"map-menu-ys-poifilter",needInApp:!1,action:"filterPoi"},{id:1,title:"我的地图",icon:"map-menu-mine",needInApp:!0,action:"openMyMap",selected:!1,whenSelected:{title:"地图总览",icon:"map-menu-mapoverview"}}],categories:[],pois:{},markers:{},showFilter:!1,userInfo:{},isMine:!1,activeIDs:{},defaultZoom:6,mapResource:{id:9,webpURL:"https://img.topgamers.cn/ymap/yuan",pngURL:"https://img.topgamers.cn/activity/yuanshen/inazuma/inazuma",shareTitle:"稻妻城地图",shareContent:"原神稻妻城地图指南，95个雷神瞳+全宝箱点位视频全收集"},infowindow:null,modals:{share:!1}}},methods:{resolveMapResource:function(){var t=this;return new Promise((function(e,i){Object(f["g"])().then((function(i){var n=t.mapResource;n.url=n.pngURL,n.postfix="png",t.mapResource=n,e()}))}))},mapTileGenerator:function(t){var e=this.mapResource,i=e.url,n=e.postfix;return"".concat(i).concat(t).concat(n)},fetchUserInfo:function(){var t=this;return this.userInfo.userId?Promise.resolve(this.userInfo):Object(f["a"])({method:"login"}).then((function(){return Object(f["a"])({method:"getUserInfo"}).then((function(e){return t.userInfo=JSON.parse(e),Promise.resolve(t.userInfo)}))}))},resetMapData:function(){var t=this;Object.getOwnPropertyNames(this.markers).forEach((function(e){var i=t.markers[e];"[object Array]"===Object.prototype.toString.call(i)&&i.forEach((function(t){t.removeFromMap()}))})),this.pois={},this.markers={},this.activeIDs=[]},reloadPoints:function(){this.resetMapData(),this.loadPoints()},loadPointCaterories:function(){var t=this,e={activity_id:this.mapResource.id};Object(m["b"])(e).then((function(e){var i=e;200===i.code?(t.categories=i.data.map((function(t){return t.is_default?t.active=!0:t.active=!1,t})),t.loadPoints()):t.$toast(i.msg,{duration:1500})}))},getLoadCategories:function(){var t=this,e=[],i=[];return this.categories.forEach((function(n){var a="marker-".concat(n.id);n.active&&i.push(a);var o=t.markers[a];n.active&&"[object Array]"!==Object.prototype.toString.call(o)?e.push(n.id):n.active&&!t.activeIDs[a]&&t.switchMarkersRelate(n)})),this.activeIDs=i,e},loadPoints:function(){var t=this,e=this.getLoadCategories();if(!(e.length<1)){var i={is_mine:this.is_mine,category_id:e.join(",")};i=Object.assign(i,this.userInfo),Object(m["d"])(i).then((function(e){var i=e;200===i.code?e.data.forEach((function(e){if(!(e.points.length<1)){var i="marker-"+e.category_id,n=t.pois[i];"[object Array]"!==Object.prototype.toString.call(n)&&(t.pois[i]=[]),e.points.forEach((function(e){t.pois[i].push(e)}));var a=[];t.pois[i].forEach((function(e){var i=t.$refs.mapvm.addMarker({lat:+e.lat,lng:+e.lng,icon:e.marker},(function(i,n){t.showInfowindow(i,n,e)}));a.push(i)})),t.markers[i]=a}})):t.$toast(i.msg,{duration:1500})}))}},doMenuAction:function(t){var e=this[t.action];e&&e(t)},filterPoi:function(){this.showFilter=!0},openMyMap:function(t){var e=this;this.inApp?t.selected?(t.selected=!1,this.is_mine=!1,this.resetMapData(),this.loadPoints()):this.fetchUserInfo().then((function(){e.userInfo.userId&&e.userInfo.sign&&(t.selected=!0,e.is_mine=!0,e.resetMapData(),e.loadPoints())})):this.$toast("请前往app使用此功能",{duration:1500})},shareMap:function(){this.inApp?this.shareByNative():this.$toast("请使用浏览器的分享功能")},shareByNative:function(){if(Object(f["f"])()){var t=this.shareLink,e={method:"showShareView",type:"link",reload:!1,data:{title:this.mapResource.shareTitle,subtitle:this.mapResource.shareContent,link:t}};Object(f["a"])(e)}else this.modals.share=!0},shareTo:function(t){var e=this,i=this.shareLink;if("Copy2Clipboard"===t.identifier)this.$copyText(i).then((function(t){e.$toast("复制成功",{duration:1500})}),(function(t){e.$toast("复制失败，请重试...")}));else{var n={method:"share",appType:t.identifier,msgType:"link",url:i,imageUrl:"https://img.topgamers.cn/icon.png",title:this.mapResource.shareTitle,content:this.mapResource.shareContent};Object(f["a"])(n)}this.modals.share=!1},switchMarkersRelate:function(t){var e=this,i="marker-".concat(t.id),n=this.markers[i];"[object Array]"===Object.prototype.toString.call(n)?(n.forEach((function(i){t.active?i.setMap(e.$refs.mapvm.map):i.setMap(null)})),this.activeIDs=[],this.categories.forEach((function(t){t.active&&e.activeIDs.push("marker-".concat(t.id))}))):t.active&&this.loadPoints()},switchAllMarkers:function(t){var e=this;t?this.loadPoints():(this.categories.forEach((function(t){e.switchMarkersRelate(t)})),this.activeIDs=[])},showInfowindow:function(t,e,i){this.infowindow&&this.infowindow.close(),this.is_mine?this.infowindowTemplate("infowindow-template",t,i):this.infowindowTemplate("infowindow-template-nologin",t,i)},infowindowTemplate:function(t,e,i){var n=document.getElementById(t).innerHTML;n=n.replace(/#{(\w+)}#/g,"{{$1}}");var a={background:v.a,place:i.name,person:i.first_member_name,target:i.redirect_type,target_param:i.redirect_params,native:this.inApp,lighting_text:i.is_lighting?"取消点亮":"点亮",challenge_id:i.challenge_id,target_lighting:!i.is_lighting,userId:this.userInfo.userId,sign:this.userInfo.sign},o=u.a.render(n,a);this.infowindow=this.$refs.mapvm.createInfoWindow(e,o)}},computed:{validMenus:function(){var t=this,e=[];return this.menus.forEach((function(i){(!i.needInApp||i.needInApp&&t.inApp)&&e.push(i)})),e}},created:function(){"isPc"!==this.clientType&&(this.defaultZoom=5)},mounted:function(){var t=this;this.resolveMapResource().then((function(){t.loadPointCaterories()})),window.flushPoints=this.reloadPoints}},_=b,x=(i("aa99"),i("6c65"),i("2877")),y=Object(x["a"])(_,n,a,!1,null,"a865df84",null);e["default"]=y.exports},e923:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"expand-bar-mobile-inter"},[i("div",{staticClass:"mobile-app"},[i("img",{attrs:{src:"https://img.topgamers.cn/img_6bdb8df1_1624005058926.png"},on:{click:function(e){return e.stopPropagation(),t.redirectToApp(e)}}}),i("a",{staticClass:"strategy-btn",attrs:{href:"https://video.topgamers.cn/video_086300ab_1600242317241.mp4",target:"_blank"}})])])},a=[],o=i("495f"),s={name:"ExpandBarPc",methods:{redirectToApp:function(){Object(o["h"])("gamecommunity",6)}}},r=s,c=(i("e9e9"),i("2877")),l=Object(c["a"])(r,n,a,!1,null,"4bca4748",null);e["a"]=l.exports},e9e9:function(t,e,i){"use strict";i("4434")}}]);